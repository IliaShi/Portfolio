# Разработка модели для выявления нерациональных диагностических направлений

## Бизнес-задача
Задача от Службы внутреннего аудита поликлиники: выявлять случаи нерационального назначения медицинских исследований врачом пациенту. Из тысяч врачебных назначений модель должна отбирать потенциально нерациональные, которые на следующем этапе анализует врач-эксперт. Таким образом, модель помогает сфокусировать внимание эксперта и сэкономить его время.  
В качестве метрики оценки качества модели выбрана f1-мера, целевой уровень 0.88 и выше.
Предоставлен датасет за 6 месяцев (>200 тыс. наблюдений), размечен врачами-экспертами.  

## Цель
Разработать модель для выявления нерациональных диагностических назначений. Задача бинарной классификации. 

## Результат
1. Целью проекта было обучение модели для выявления нерациональных диагностических назначений врачей. Предоставлен датасет с данными за 6 месяцев, более 200 тыс. наблюдений.
2. На этапе исследовательского анализа и предобработки:
* изучено распределение данных
* удалены дубликаты
* обработаны категориальные переменные
* удалены выбросы
* создан новый параметр
Этапы предобработки реализованы в форме пайплайна.
3. По итогу корреляционного анализа удалены несколько высокоскоррелированных параметров
4. Обучены две модели - CatBoost и нейросеть. f1-мера на трейне: CatBoost - 0.99 и нейросеть - 0.97. 
Выбрана модель на базе градиентного бустинга как более точная и более простая. На тестовых данных модель показала точность 0.94, что удовлетворяет требованиям заказчика.
5. Работа модели основана на сопоставлении диагноза и назначенного исследования, модель также учитывает возраст пациента и повод обращения. Таким образом, разработана модель, способная определять случаи нерационального назначения диагностических процедур.

Рекомендации заказчику.  

Несколько увеличить метрику качества можно, если предоставить больше параметров для анализа. Также, развивая идею контроля врачебных назначений, можно разработать модель, анализирующую протокол приема врача средствами NLP, которая могла бы оценить соответствие жалоб и выявленных симптомов установленному диагнозу, а также корректность данных пациенту рекомендаций.
