# Предсказание температуры сплава.
## Цель проекта
Разработать модель для предсказания температуры сплава с целью сокращения энергопотребления и оптимизации расходов предприятия.  

Металлургический комбинат решил уменьшить потребление электроэнергии на этапе обработки стали. Для этого комбинату нужно контролировать температуру сплава. Позставлена задача — построить модель, которая сможет предсказывать финальную температуру сплава, используя технические параметры по обработке партии стали.  Заказчик планирует использовать разработанную модель для имитации технологического процесса.  
Метрика качества - MAE, целевое значение 6.8 и менее на тестовой выборке.  

Таргет - финальная температура сплава.  
Дополнительные условия заказчика:
* соотношение трейн:тест - 3:1
* из тестовой выборки не удалять выбросы
* итоговую модель проверить на адекватность сравнением с константной моделью

## Результат 
1. Целью проекта было предсказание финальной температуры сплава. Предоставлены 7 отдельных датасетов с данными о примерно 3200 партиях.
2. На этапе исследовательского анализа и предобработки данных:
* изучено распределение данных
* удалены аномалии, вызванные отклонениями от технологического процесса
* удалены партии с пропусками по измерениям температуры
* удалены данные о редкоиспользуемых добавках (менее 10% партий)
* созданы новые признаки:
    * полная электрическая мощность, затраченная на нагрев сплава
    * длительность нагрева сплава
    * количество итераций нагрева
    * время обработки одной партии сплава
    * расход электроэнергии на одну партию
    * общий объем сыпучих, а также проволочных материалов
    * начальная температура сплава
    * финальная температура сплава (таргет)
    * минимальная и максимальная температура сплава на промежуточных итерациях
3. Объединенный датасет содержит данные о 2323 наблюдениях, 22 параметра и таргет. Оценена зависимость таргета от параметров визуально и с помощью корреляционного анализа. Удалены высокоскоррелированные признаки и признаки без заметной корреляцией с таргетом.
4. Данные разделены на тренировочную и тестовую выборки. Из тестовой выборки удалены статистические выбросы. В результате тренировочная выборка содержит 1649 наблюдений и 14 параметров, тестовая выборка - 582 наблюдение. 
5. Обучены три модели: линейная регрессия, случайный лес и градиентный бустинг (LightGBM), две последние - с перебором гиперпараметров. Получены МАЕ моделей на кросс-валидации:  
Линейная регрессия: 4.66  
Случайный лес: 4.41  
LightGBM: 4.28  
Наилучшей моделью оказалась LightGBM. МАЕ на кросс-валидациии 4.28, на тестовых данных - 4.41. Эффективность модели также доказана при сравнении с константной моделью. Наиболее значимыми признаками оказались максимальная и минимальная температура на промежуточных итерациях, а также расход электроэнергии.  
Таким образом, разработана модель, способная предсказывать финальную температуру сплава с заданной точностью.

Рекомендации заказчику:
1. Разработанная модель может быть использована для предсказания финальной температуры сплава
2. В рамках дальнейшей оптимизации энергозатрат можно разработать модель, предсказывающую температуру и/или необходимую длительность включения электродов на каждой итерации технологического процесса.
3. Для повышения точности модели рекомендуется представить более полные данные за больший период наблюдений, а также, по-возможности, дополнительные данные, например марку изготовляемой стали, начальную массу или объем сплава в каждой партии и т.п.

